<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <title>AgriSense Pro - System Settings</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="phone-frame" style="max-width: 100%; height: 100%;">
        <div class="header">
            <div class="header-title">
                <i class="fas fa-cog"></i>
                System Settings
            </div>
            <div class="header-actions">
                <a href="index.html" class="header-icon" title="Back to Dashboard"><i class="fas fa-home"></i></a>
                <span class="header-icon" onclick="saveAllSettings()" title="Save All Settings"><i class="fas fa-save"></i></span>
            </div>
        </div>

        <div class="search-bar">
            <input type="text" placeholder="Search settings..." id="settingsSearch">
            <i class="fas fa-search search-icon"></i>
        </div>

        <div class="content" style="max-width: 100%;">
            <div class="section">
                <div class="section-header">
                    <div class="section-title">
                        <i class="fas fa-palette"></i>
                        Appearance
                    </div>
                    <div class="action-buttons">
                        <span class="btn" onclick="restoreDefaultAppearance()">Restore Defaults</span>
                    </div>
                </div>

                <div style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: space-between;">
                    <div class="settings-item" style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-label">
                            <div class="settings-title">Theme</div>
                            <div class="settings-description">Change the application theme</div>
                        </div>
                        <div class="settings-control">
                            <select id="themeSelect" class="settings-select" onchange="previewTheme(this.value)">
                                <option value="light">Light</option>
                                <option value="dark">Dark</option>
                                <option value="nature">Nature</option>
                                <option value="custom">Custom</option>
                            </select>
                        </div>
                    </div>

                    <div class="settings-item" style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-label">
                            <div class="settings-title">Font Size</div>
                            <div class="settings-description">Adjust text size across the application</div>
                        </div>
                        <div class="settings-control">
                            <select id="fontSizeSelect" class="settings-select" onchange="previewFontSize(this.value)">
                                <option value="small">Small</option>
                                <option value="medium" selected>Medium</option>
                                <option value="large">Large</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: space-between;">
                    <div class="settings-item" style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-label">
                            <div class="settings-title">Dark Mode</div>
                            <div class="settings-description">Enable dark mode for low-light environments</div>
                        </div>
                        <div class="settings-control">
                            <label class="switch">
                                <input type="checkbox" id="darkModeToggle" onchange="toggleDarkMode(this.checked)">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <div class="settings-item" style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-label">
                            <div class="settings-title">Accent Color</div>
                            <div class="settings-description">Change the primary accent color</div>
                        </div>
                        <div class="settings-control">
                            <input type="color" id="accentColorPicker" value="#4caf50" onchange="previewAccentColor(this.value)">
                        </div>
                    </div>
                </div>

                <div style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: space-between;">
                    <div class="settings-item" style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-label">
                            <div class="settings-title">Animations</div>
                            <div class="settings-description">Enable or disable interface animations</div>
                        </div>
                        <div class="settings-control">
                            <label class="switch">
                                <input type="checkbox" id="animationsToggle" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <div class="settings-item" style="flex: 1; min-width: 300px; max-width: 48%;">
                        <!-- Empty placeholder to maintain the grid layout -->
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-title">
                        <i class="fas fa-sliders-h"></i>
                        System Preferences
                    </div>
                    <div class="action-buttons">
                        <span class="btn" onclick="testConnection()">Test Connection</span>
                    </div>
                </div>

                <div style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: space-between;">
                    <div style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Units</div>
                                <div class="settings-description">Set your preferred measurement units</div>
                            </div>
                            <div class="settings-control">
                                <select id="unitSelect" class="settings-select">
                                    <option value="imperial">Imperial (°F, mph)</option>
                                    <option value="metric">Metric (°C, km/h)</option>
                                </select>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Language</div>
                                <div class="settings-description">Set your preferred language</div>
                            </div>
                            <div class="settings-control">
                                <select id="languageSelect" class="settings-select">
                                    <option value="en">English</option>
                                    <option value="es">Spanish</option>
                                    <option value="fr">French</option>
                                    <option value="de">German</option>
                                    <option value="zh">Chinese</option>
                                    <option value="ja">Japanese</option>
                                    <option value="ru">Russian</option>
                                </select>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Update Frequency</div>
                                <div class="settings-description">How often to refresh sensor data</div>
                            </div>
                            <div class="settings-control">
                                <select id="updateFreq" class="settings-select">
                                    <option value="2000">2 Seconds</option>
                                    <option value="5000">5 Seconds</option>
                                    <option value="10000" selected>10 Seconds</option>
                                    <option value="30000">30 Seconds</option>
                                    <option value="60000">1 Minute</option>
                                    <option value="300000">5 Minutes</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Auto-Sync</div>
                                <div class="settings-description">Automatically sync data with server</div>
                            </div>
                            <div class="settings-control">
                                <label class="switch">
                                    <input type="checkbox" id="autoSyncToggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Data Backup Frequency</div>
                                <div class="settings-description">How often to backup your data</div>
                            </div>
                            <div class="settings-control">
                                <select id="backupFreq" class="settings-select">
                                    <option value="daily">Daily</option>
                                    <option value="weekly" selected>Weekly</option>
                                    <option value="monthly">Monthly</option>
                                </select>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Cloud Storage</div>
                                <div class="settings-description">Store your data in the cloud</div>
                            </div>
                            <div class="settings-control">
                                <label class="switch">
                                    <input type="checkbox" id="cloudStorageToggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-title">
                        <i class="fas fa-bell"></i>
                        Notifications
                    </div>
                    <div class="action-buttons">
                        <span class="btn" onclick="testNotification()">Test Notification</span>
                    </div>
                </div>

                <div style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: space-between;">
                    <div style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Enable Notifications</div>
                                <div class="settings-description">Receive alerts for important events</div>
                            </div>
                            <div class="settings-control">
                                <label class="switch">
                                    <input type="checkbox" id="notifyToggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Temperature Alert Threshold</div>
                                <div class="settings-description">Alert when temperature exceeds this value</div>
                            </div>
                            <div class="settings-control">
                                <input type="range" id="tempThresholdSlider" min="0" max="120" value="80" oninput="updateTempThreshold(this.value)">
                                <span id="tempThresholdValue">80°F</span>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Humidity Alert Threshold</div>
                                <div class="settings-description">Alert when humidity falls below this value</div>
                            </div>
                            <div class="settings-control">
                                <input type="range" id="humidThresholdSlider" min="0" max="100" value="60" oninput="updateHumidThreshold(this.value)">
                                <span id="humidThresholdValue">60%</span>
                            </div>
                        </div>
                    </div>

                    <div style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Battery Alert Threshold</div>
                                <div class="settings-description">Alert when battery falls below this value</div>
                            </div>
                            <div class="settings-control">
                                <input type="range" id="batteryThresholdSlider" min="0" max="100" value="20" oninput="updateBatteryThreshold(this.value)">
                                <span id="batteryThresholdValue">20%</span>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Notification Methods</div>
                                <div class="settings-description">Select how you want to be notified</div>
                            </div>
                            <div class="settings-control">
                                <div class="checkbox-group">
                                    <label><input type="checkbox" checked> In-App</label>
                                    <label><input type="checkbox" checked> Email</label>
                                    <label><input type="checkbox"> SMS</label>
                                    <label><input type="checkbox" checked> Push</label>
                                </div>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Alert Priority</div>
                                <div class="settings-description">Set minimum priority for notifications</div>
                            </div>
                            <div class="settings-control">
                                <select id="alertPriority" class="settings-select">
                                    <option value="all">All Alerts</option>
                                    <option value="medium" selected>Medium & High</option>
                                    <option value="high">High Only</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-title">
                        <i class="fas fa-database"></i>
                        Data Management
                    </div>
                    <div class="action-buttons">
                        <span class="btn" onclick="analyzeDataUsage()">Analyze Usage</span>
                    </div>
                </div>

                <div style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: space-between;">
                    <div style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Data Retention</div>
                                <div class="settings-description">How long to keep historical data</div>
                            </div>
                            <div class="settings-control">
                                <select id="dataRetention" class="settings-select">
                                    <option value="30">30 Days</option>
                                    <option value="90">90 Days</option>
                                    <option value="365" selected>1 Year</option>
                                    <option value="730">2 Years</option>
                                    <option value="unlimited">Unlimited</option>
                                </select>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Data Storage Usage</div>
                                <div class="settings-description">Current storage utilization</div>
                            </div>
                            <div class="settings-control">
                                <div class="progress-bar" style="margin: 0;">
                                    <div class="progress-fill" style="width: 42%;" title="Storage Usage"></div>
                                </div>
                                <div style="font-size: 12px; margin-top: 5px; text-align: right;">16.8 GB / 40 GB</div>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Export All Data</div>
                                <div class="settings-description">Download all sensor and crop data</div>
                            </div>
                            <div class="settings-control">
                                <div class="button-group">
                                    <button class="settings-button" onclick="exportData('csv')">CSV</button>
                                    <button class="settings-button" onclick="exportData('json')">JSON</button>
                                    <button class="settings-button" onclick="exportData('excel')">Excel</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Clear Cache</div>
                                <div class="settings-description">Reset local application cache</div>
                            </div>
                            <div class="settings-control">
                                <button class="settings-button" onclick="clearCache()">Clear</button>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Reset All Settings</div>
                                <div class="settings-description">Restore default settings</div>
                            </div>
                            <div class="settings-control">
                                <button class="settings-button settings-danger" onclick="resetSettings()">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-title">
                        <i class="fas fa-microchip"></i>
                        Sensor Management
                    </div>
                    <div class="action-buttons">
                        <span class="btn" onclick="scanForSensors()">Scan for Sensors</span>
                    </div>
                </div>

                <div style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: space-between;">
                    <div style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Sensor Calibration Frequency</div>
                                <div class="settings-description">How often sensors are automatically calibrated</div>
                            </div>
                            <div class="settings-control">
                                <select id="calibrationFreq" class="settings-select">
                                    <option value="7">Weekly</option>
                                    <option value="14" selected>Bi-weekly</option>
                                    <option value="30">Monthly</option>
                                    <option value="90">Quarterly</option>
                                </select>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Auto-Discovery</div>
                                <div class="settings-description">Automatically detect new sensors in range</div>
                            </div>
                            <div class="settings-control">
                                <label class="switch">
                                    <input type="checkbox" id="autoDiscoveryToggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Field Network Range</div>
                                <div class="settings-description">Set maximum detection range for sensors</div>
                            </div>
                            <div class="settings-control">
                                <select id="sensorRange" class="settings-select">
                                    <option value="500">500 meters</option>
                                    <option value="1000" selected>1 kilometer</option>
                                    <option value="2000">2 kilometers</option>
                                    <option value="5000">5 kilometers</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Sensor Health Check</div>
                                <div class="settings-description">Frequency of sensor diagnostics</div>
                            </div>
                            <div class="settings-control">
                                <select id="healthCheckFreq" class="settings-select">
                                    <option value="3600">Hourly</option>
                                    <option value="86400" selected>Daily</option>
                                    <option value="604800">Weekly</option>
                                </select>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Battery Optimization</div>
                                <div class="settings-description">Enable to extend sensor battery life</div>
                            </div>
                            <div class="settings-control">
                                <label class="switch">
                                    <input type="checkbox" id="batteryOptToggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-title">
                        <i class="fas fa-lock"></i>
                        Security & Privacy
                    </div>
                </div>

                <div style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: space-between;">
                    <div style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Two-Factor Authentication</div>
                                <div class="settings-description">Add an extra layer of security</div>
                            </div>
                            <div class="settings-control">
                                <label class="switch">
                                    <input type="checkbox" id="twoFactorToggle">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Data Encryption</div>
                                <div class="settings-description">Encrypt all stored data</div>
                            </div>
                            <div class="settings-control">
                                <label class="switch">
                                    <input type="checkbox" id="encryptionToggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Session Timeout</div>
                                <div class="settings-description">Auto-logout after inactivity</div>
                            </div>
                            <div class="settings-control">
                                <select id="sessionTimeout" class="settings-select">
                                    <option value="300">5 Minutes</option>
                                    <option value="900">15 Minutes</option>
                                    <option value="1800" selected>30 Minutes</option>
                                    <option value="3600">60 Minutes</option>
                                    <option value="0">Never</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Change Password</div>
                                <div class="settings-description">Update your login credentials</div>
                            </div>
                            <div class="settings-control">
                                <button class="settings-button" onclick="changePassword()">Change</button>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Account Activity</div>
                                <div class="settings-description">View login history and sessions</div>
                            </div>
                            <div class="settings-control">
                                <button class="settings-button" onclick="viewAccountActivity()">View</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-title">
                        <i class="fas fa-info-circle"></i>
                        About
                    </div>
                </div>

                <div class="settings-item">
                    <div class="settings-label">
                        <div class="settings-title">Version</div>
                        <div class="settings-description">Current application version</div>
                    </div>
                    <div class="settings-control">
                        <span>5.2.1</span>
                    </div>
                </div>

                <div style="margin: 15px; padding: 20px; background: linear-gradient(135deg, #f1f8e9, #e8f5e9); border-radius: 12px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                    <div style="font-weight: bold; margin-bottom: 8px; font-size: 18px; color: #2e7d32;">AgriSensePro Premier Edition</div>
                    <div style="font-size: 14px; color: #555; margin-bottom: 12px;">Licensed to: Western Farm Operations Inc.</div>
                    <div class="status-badge success" style="margin: 8px auto; display: inline-block;">Active Subscription</div>
                    <div style="font-size: 13px; color: #666; margin-top: 10px;">Next renewal: March 15, 2026</div>
                    <div style="font-size: 13px; color: #666; margin-top: 5px;">Support plan: Enterprise 24/7</div>
                    <div style="margin-top: 15px; display: flex; gap: 10px; justify-content: center;">
                        <button class="settings-button" style="background: #388e3c;">Manage Subscription</button>
                        <button class="settings-button" style="background: #0288d1;">Upgrade Plan</button>
                    </div>
                </div>

                <div class="settings-item">
                    <div class="settings-label">
                        <div class="settings-title">Contact Support</div>
                        <div class="settings-description">Get help with AgriSense Pro</div>
                    </div>
                    <div class="settings-control">
                        <button class="settings-button" onclick="contactSupport()">Contact</button>
                    </div>
                </div>

                <div style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: space-between;">
                    <div style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Privacy Policy</div>
                                <div class="settings-description">View our privacy policy</div>
                            </div>
                            <div class="settings-control">
                                <button class="settings-button" onclick="viewPrivacyPolicy()">View</button>
                            </div>
                        </div>

                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Terms of Service</div>
                                <div class="settings-description">View our terms of service</div>
                            </div>
                            <div class="settings-control">
                                <button class="settings-button" onclick="viewTermsOfService()">View</button>
                            </div>
                        </div>
                    </div>

                    <div style="flex: 1; min-width: 300px; max-width: 48%;">
                        <div class="settings-item">
                            <div class="settings-label">
                                <div class="settings-title">Check for Updates</div>
                                <div class="settings-description">Update to the latest version</div>
                            </div>
                            <div class="settings-control">
                                <button class="settings-button" onclick="checkForUpdates()">Check</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div style="margin: 30px 0; text-align: center;">
                <button class="settings-button" style="width: 220px; padding: 15px; font-size: 16px; box-shadow: 0 8px 15px rgba(76, 175, 80, 0.3); background: linear-gradient(135deg, #4caf50, #2e7d32); border-radius: 30px;" onclick="saveAllSettings()">Save All Settings</button>
            </div>
        </div>

        <div class="nav-bar">
            <a href="index.html" class="nav-item" title="Farm Dashboard">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </a>
            <a href="sensors.html" class="nav-item" title="Sensor Management">
                <i class="fas fa-microchip"></i>
                <span>Sensors</span>
            </a>
            <a href="weather.html" class="nav-item" title="Weather Command Station">
                <i class="fas fa-cloud-sun"></i>
                <span>Weather</span>
            </a>
            <a href="analytics.html" class="nav-item" title="Data Analytics">
                <i class="fas fa-chart-line"></i>
                <span>Analytics</span>
            </a>
            <a href="alerts.html" class="nav-item" title="Alert Command Center">
                <i class="fas fa-bell"></i>
                <span>Alerts</span>
            </a>
            <a href="settings.html" class="nav-item active" title="System Settings">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </a>
        </div>
    </div>

    <script>
        // Load saved settings when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedSettings();
            setupSearchFilter();
            initializeSliders();
        });

        function loadSavedSettings() {
            // In a real application, this would load settings from localStorage or a server
            console.log("Loading saved settings...");

            // Default or previously saved settings could be loaded here
            // For this example, we'll just use the defaults set in the HTML
        }

        function setupSearchFilter() {
            // Filter settings as user types in search box
            const searchInput = document.getElementById('settingsSearch');
            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    const query = this.value.toLowerCase();
                    document.querySelectorAll('.settings-item').forEach(item => {
                        const title = item.querySelector('.settings-title').textContent.toLowerCase();
                        const desc = item.querySelector('.settings-description').textContent.toLowerCase();

                        if (title.includes(query) || desc.includes(query)) {
                            item.style.display = '';
                        } else {
                            item.style.display = 'none';
                        }
                    });

                    // Hide section headers if all items in that section are hidden
                    document.querySelectorAll('.section').forEach(section => {
                        const visibleItems = section.querySelectorAll('.settings-item[style="display: none;"]');
                        if (visibleItems.length === section.querySelectorAll('.settings-item').length) {
                            section.style.display = 'none';
                        } else {
                            section.style.display = '';
                        }
                    });
                });
            }
        }

        function initializeSliders() {
            // Set up the range sliders
            updateTempThreshold(document.getElementById('tempThresholdSlider')?.value || 80);
            updateHumidThreshold(document.getElementById('humidThresholdSlider')?.value || 60);
            updateBatteryThreshold(document.getElementById('batteryThresholdSlider')?.value || 20);
        }

        function updateTempThreshold(value) {
            document.getElementById('tempThresholdValue').textContent = `${value}°F`;
        }

        function updateHumidThreshold(value) {
            document.getElementById('humidThresholdValue').textContent = `${value}%`;
        }

        function updateBatteryThreshold(value) {
            document.getElementById('batteryThresholdValue').textContent = `${value}%`;
        }

        function saveAllSettings() {
            // Get all settings from form elements
            const settings = {
                theme: document.getElementById('themeSelect').value,
                fontSize: document.getElementById('fontSizeSelect').value,
                darkMode: document.getElementById('darkModeToggle').checked,
                accentColor: document.getElementById('accentColorPicker').value,
                animations: document.getElementById('animationsToggle').checked,
                units: document.getElementById('unitSelect').value,
                language: document.getElementById('languageSelect').value,
                updateFreq: document.getElementById('updateFreq').value,
                autoSync: document.getElementById('autoSyncToggle').checked,
                backupFreq: document.getElementById('backupFreq').value,
                cloudStorage: document.getElementById('cloudStorageToggle').checked,
                notificationsEnabled: document.getElementById('notifyToggle').checked,
                tempThreshold: document.getElementById('tempThresholdSlider').value,
                humidThreshold: document.getElementById('humidThresholdSlider').value,
                batteryThreshold: document.getElementById('batteryThresholdSlider').value,
                alertPriority: document.getElementById('alertPriority').value,
                dataRetention: document.getElementById('dataRetention').value,
                calibrationFreq: document.getElementById('calibrationFreq').value,
                autoDiscovery: document.getElementById('autoDiscoveryToggle').checked,
                sensorRange: document.getElementById('sensorRange').value,
                healthCheckFreq: document.getElementById('healthCheckFreq').value,
                batteryOpt: document.getElementById('batteryOptToggle').checked,
                twoFactor: document.getElementById('twoFactorToggle').checked,
                encryption: document.getElementById('encryptionToggle').checked,
                sessionTimeout: document.getElementById('sessionTimeout').value
            };

            // In a real application, this would save to localStorage or a server
            console.log("Saving settings:", settings);

            // Show a success notification
            showNotification('Settings saved successfully!', 'success');
        }

        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification-toast ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;

            // Style the notification
            Object.assign(notification.style, {
                position: 'fixed',
                bottom: '80px',
                left: '50%',
                transform: 'translateX(-50%)',
                backgroundColor: type === 'success' ? '#4caf50' : '#2196f3',
                color: 'white',
                padding: '12px 24px',
                borderRadius: '30px',
                boxShadow: '0 5px 15px rgba(0,0,0,0.2)',
                zIndex: '9999',
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
                fontSize: '14px',
                fontWeight: '500',
                opacity: '0',
                transition: 'opacity 0.3s, transform 0.3s'
            });

            // Add to document
            document.body.appendChild(notification);

            // Animate in
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateX(-50%) translateY(0)';
            }, 10);

            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(-50%) translateY(20px)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        function previewTheme(theme) {
            // In a real application, this would update the page theme
            console.log("Previewing theme:", theme);

            // Example of how this might work
            const body = document.body;
            body.classList.remove('theme-light', 'theme-dark', 'theme-nature', 'theme-custom');
            body.classList.add(`theme-${theme}`);

            // Show theme preview effects
            if (theme === 'dark') {
                body.style.backgroundColor = '#333';
                document.querySelectorAll('.section').forEach(section => {
                    section.style.backgroundColor = '#444';
                    section.style.color = '#fff';
                });
                document.querySelectorAll('.settings-item').forEach(item => {
                    item.style.borderBottomColor = '#555';
                });
            } else if (theme === 'nature') {
                body.style.backgroundColor = '#e8f5e9';
                document.querySelectorAll('.section').forEach(section => {
                    section.style.backgroundColor = '#f1f8e9';
                });
            } else {
                // Reset to default
                body.style.backgroundColor = '';
                document.querySelectorAll('.section').forEach(section => {
                    section.style.backgroundColor = '';
                    section.style.color = '';
                });
                document.querySelectorAll('.settings-item').forEach(item => {
                    item.style.borderBottomColor = '';
                });
            }

            // Show notification
            showNotification('Theme preview applied. Save settings to keep this theme.', 'info');
        }

        function previewAccentColor(color) {
            document.documentElement.style.setProperty('--primary-color', color);
            document.documentElement.style.setProperty('--secondary-color', adjustColor(color, -20));
            document.documentElement.style.setProperty('--dark-color', adjustColor(color, -40));
            document.documentElement.style.setProperty('--light-color', adjustColor(color, 60));

            showNotification('Accent color updated. Save settings to keep this color.', 'info');
        }

        function adjustColor(hex, percent) {
            // Convert hex to RGB
            let r = parseInt(hex.substring(1,3), 16);
            let g = parseInt(hex.substring(3,5), 16);
            let b = parseInt(hex.substring(5,7), 16);

            // Adjust
            r = Math.max(0, Math.min(255, r + percent));
            g = Math.max(0, Math.min(255, g + percent));
            b = Math.max(0, Math.min(255, b + percent));

            // Convert back to hex
            return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        }

        function previewFontSize(size) {
            // In a real application, this would update the page font size
            console.log("Previewing font size:", size);

            // Example of how this might work
            const root = document.documentElement;

            if (size === 'small') {
                root.style.fontSize = '14px';
            } else if (size === 'medium') {
                root.style.fontSize = '16px';
            } else if (size === 'large') {
                root.style.fontSize = '18px';
            }

            showNotification('Font size updated. Save settings to keep this size.', 'info');
        }

        function toggleDarkMode(enabled) {
            // In a real application, this would toggle dark mode
            console.log("Dark mode:", enabled);

            // Example of how this might work
            if (enabled) {
                document.getElementById('themeSelect').value = 'dark';
                previewTheme('dark');
            } else {
                document.getElementById('themeSelect').value = 'light';
                previewTheme('light');
            }
        }

        function restoreDefaultAppearance() {
            document.getElementById('themeSelect').value = 'light';
            document.getElementById('fontSizeSelect').value = 'medium';
            document.getElementById('darkModeToggle').checked = false;
            document.getElementById('accentColorPicker').value = '#4caf50';
            document.getElementById('animationsToggle').checked = true;

            // Reset appearance
            previewTheme('light');
            previewFontSize('medium');
            previewAccentColor('#4caf50');

            showNotification('Default appearance restored', 'success');
        }

        function exportData(format) {
            console.log(`Exporting data in ${format} format...`);
            showNotification(`Preparing ${format.toUpperCase()} export. Download will start shortly.`, 'info');
        }

        function clearCache() {
            // In a real application, this would clear the cache
            console.log("Clearing cache...");

            if (confirm("Are you sure you want to clear the application cache? This may log you out.")) {
                showNotification('Cache cleared successfully', 'success');
            }
        }

        function resetSettings() {
            // In a real application, this would reset all settings to defaults
            console.log("Resetting settings...");

            if (confirm("Are you sure you want to reset all settings to default values? This cannot be undone.")) {
                // Reset all form elements to defaults
                document.querySelectorAll('select').forEach(select => {
                    const defaultOption = select.querySelector('option[selected]');
                    if (defaultOption) {
                        select.value = defaultOption.value;
                    }
                });

                document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                    if (checkbox.hasAttribute('checked')) {
                        checkbox.checked = true;
                    } else {
                        checkbox.checked = false;
                    }
                });

                // Reset range sliders
                document.getElementById('tempThresholdSlider').value = 80;
                document.getElementById('humidThresholdSlider').value = 60;
                document.getElementById('batteryThresholdSlider').value = 20;

                updateTempThreshold(80);
                updateHumidThreshold(60);
                updateBatteryThreshold(20);

                // Reset appearance
                restoreDefaultAppearance();

                showNotification('All settings reset to defaults', 'success');
            }
        }

        function contactSupport() {
            showNotification('Opening support contact options', 'info');
            setTimeout(() => {
                alert("Support contact: support@agrisensepro.com\n\nPhone: 1-800-123-4567\n\nAvailable 24/7");
            }, 500);
        }

        function viewPrivacyPolicy() {
            showNotification('Loading privacy policy', 'info');
            setTimeout(() => {
                alert("Privacy Policy would be displayed here.");
            }, 500);
        }

        function viewTermsOfService() {
            showNotification('Loading terms of service', 'info');
            setTimeout(() => {
                alert("Terms of Service would be displayed here.");
            }, 500);
        }

        function testConnection() {
            showNotification('Testing server connection...', 'info');
            setTimeout(() => {
                showNotification('Connection successful! Latency: 42ms', 'success');
            }, 1500);
        }

        function testNotification() {
            showNotification('This is a test notification', 'info');
        }

        function analyzeDataUsage() {
            showNotification('Analyzing data usage...', 'info');
            setTimeout(() => {
                alert("Data Usage Analysis\n\nTotal Storage: 16.8 GB\nSensor Data: 12.2 GB\nWeather Data: 3.5 GB\nAnalytics: 1.1 GB\n\nEstimated Growth: 250 MB/week");
            }, 1500);
        }

        function scanForSensors() {
            showNotification('Scanning for nearby sensors...', 'info');
            setTimeout(() => {
                showNotification('Found 3 new sensors! Click to view details.', 'success');
            }, 2000);
        }

        function changePassword() {
            alert("Password change form would appear here.");
        }

        function viewAccountActivity() {
            alert("Account Activity Log\n\nLast Login: March 6, 2025 14:32:15\nIP Address: 192.168.1.45\nActive Sessions: 1\nLast Password Change: January 15, 2025");
        }

        function checkForUpdates() {
            showNotification('Checking for updates...', 'info');
            setTimeout(() => {
                showNotification('You\'re running the latest version!', 'success');
            }, 1500);
        }
    </script>

    <style>
        /* Inline styles for settings page enhancements */
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
        }

        .button-group {
            display: flex;
            gap: 5px;
        }

        .settings-item {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s;
        }

        .settings-item:hover {
            background: rgba(0,0,0,0.02);
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .settings-label {
            display: flex;
            flex-direction: column;
            flex: 1;
        }

        .settings-title {
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--text-primary);
        }

        .settings-description {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .settings-control {
            min-width: 120px;
            display: flex;
            justify-content: flex-end;
            align-items: center;
        }

        .settings-select, .settings-input {
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background-color: white;
            min-width: 120px;
            font-size: 14px;
            transition: border 0.3s, box-shadow 0.3s;
        }

        .settings-select:focus, .settings-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
            outline: none;
        }

        input[type="color"] {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        input[type="range"] {
            width: 140px;
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .notification-toast {
            animation: slideInUp 0.3s, fadeOut 0.3s 2.7s;
        }

        @keyframes slideInUp {
            from { transform: translateX(-50%) translateY(20px); opacity: 0; }
            to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
    </style>
</body>
</html>